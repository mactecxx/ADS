<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAIPS Notes Canada - Official GCMS File Service</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --theme-primary: #0891b2; /* Cyan-600 */
            --theme-secondary: #f0f9ff; /* Sky-50 */
        }
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; /* Slate-50 */ }
        .text-theme { color: var(--theme-primary); }
        .bg-theme { background-color: var(--theme-primary); }
        .border-theme { border-color: var(--theme-primary); }
        .hover\:bg-theme-dark:hover { background-color: #0e7490; /* Cyan-700 */ }
        .review-carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
        }
        .review-card {
            flex: 0 0 100%;
        }
        @media (min-width: 768px) {
            .review-card {
                flex: 0 0 calc(50% - 1rem);
            }
        }
        @media (min-width: 1024px) {
            .review-card {
                flex: 0 0 calc(33.333% - 1.34rem);
            }
        }
    </style>
</head>
<body class="text-slate-800">

    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <nav class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="#" class="text-2xl font-extrabold text-theme">
                CAIPS Notes Canada
            </a>
            <div class="flex items-center space-x-4">
                <div class="relative group hidden md:inline">
                    <button class="text-sm font-medium text-slate-600 hover:text-theme flex items-center">
                        <span>What's Inside Your File?</span>
                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="absolute z-10 hidden group-hover:block bg-white shadow-lg rounded-lg mt-2 p-6 w-max border">
                        <div class="grid grid-cols-2 gap-x-12 gap-y-6">
                            <div>
                                <h3 class="font-bold text-slate-800 mb-2">Notes on Identity Proofs</h3>
                                <ul class="space-y-1 text-sm text-slate-600">
                                    <li>Aadhaar Card</li>
                                    <li>Driving License</li>
                                    <li>Birth Certificate</li>
                                    <li>Passport Copy</li>
                                </ul>
                            </div>
                             <div>
                                <h3 class="font-bold text-slate-800 mb-2">Notes on Financial Proofs</h3>
                                <ul class="space-y-1 text-sm text-slate-600">
                                    <li>Bank Statements</li>
                                    <li>Income Tax Returns (ITR)</li>
                                    <li>Fixed Deposit Receipts</li>
                                    <li>Property Valuation</li>
                                </ul>
                            </div>
                             <div>
                                <h3 class="font-bold text-slate-800 mb-2">Notes on Travel Documents</h3>
                                <ul class="space-y-1 text-sm text-slate-600">
                                    <li>Passport (All Pages)</li>
                                    <li>Flight Confirmations</li>
                                    <li>Travel Itinerary</li>
                                    <li>Travel Insurance</li>
                                </ul>
                            </div>
                             <div>
                                <h3 class="font-bold text-slate-800 mb-2">Notes on Supporting Docs</h3>
                                <ul class="space-y-1 text-sm text-slate-600">
                                    <li>Statement of Purpose (SOP)</li>
                                    <li>Letter of Invitation</li>
                                    <li>University / Company Offer Letter</li>
                                    <li>Medical Examination</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <a href="#reviews" class="hidden md:inline text-sm font-medium text-slate-600 hover:text-theme">Reviews</a>
                <a href="#contact" class="hidden md:inline text-sm font-medium text-slate-600 hover:text-theme">Support</a>
                <a href="login.html" class="bg-theme hover:bg-theme-dark text-white font-bold py-2 px-5 rounded-lg text-sm transition-colors duration-300">Login</a>
                <a href="#form-section" class="bg-theme hover:bg-theme-dark text-white font-bold py-2 px-5 rounded-lg text-sm transition-colors duration-300">
                    Request File
                </a>
            </div>
        </nav>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-16">

        <section class="text-center">
            <h1 class="text-4xl md:text-6xl font-extrabold text-slate-900 leading-tight">
                Unlock the Story Behind Your<br class="hidden md:block"> Canada Visa Decision.
            </h1>
            <p class="mt-6 text-lg text-slate-600 max-w-3xl mx-auto">
                Stop wondering why your visa was refused or Visa is delayed. Get the official GCMS/CAIPS file used by IRCC officers to see the exact notes, documents, and reasoning behind your application's outcome.
            </p>
            <div class="mt-10">
                <a href="#form-section" class="bg-theme hover:bg-theme-dark text-white font-bold py-4 px-8 rounded-lg text-lg transition-colors duration-300 shadow-lg">
                    Get Your Official File
                </a>
            </div>
        </section>

        <main class="max-w-5xl mx-auto px-4 sm:px-6 py-8 md:py-12">
        <section class="text-center">
            <h2 class="text-4xl md:text-5xl font-bold text-slate-800 leading-tight"></h2>
            <p class="mt-4 text-lg text-slate-600 max-w-3xl mx-auto"></p>
            <ul class="mt-8 space-y-3 text-slate-600 inline-block text-left">
                <li class="flex items-start">
                    <svg class="w-6 h-6 text-theme mr-3 mt-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span><strong>Full Transparency:</strong> See every document and statement that was submitted.</span>
                </li>
                <li class="flex items-start">
                    <svg class="w-6 h-6 text-theme mr-3 mt-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span><strong>Identify Mistakes:</strong> Find the exact errors that may have led to your refusal.</span>
                </li>
                <li class="flex items-start">
                    <svg class="w-6 h-6 text-theme mr-3 mt-1 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span><strong>Prepare for the Future:</strong> Use the official file to plan your re-application or appeal.</span>
                </li>
            </ul>
        </section>

        <section class="py-16">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-800">A Simple & Secure Process</h2>
                <p class="text-slate-600 mt-2">Get your complete visa file in four easy steps.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">
                 <div class="text-center">
                    <div class="flex items-center justify-center h-20 w-20 mx-auto bg-blue-50 rounded-full"><svg class="h-10 w-10 text-theme" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg></div>
                    <h3 class="mt-4 font-semibold text-slate-800">1. Submit & Pay</h3>
                    <p class="mt-1 text-sm text-slate-500">Fill out the secure form with your details and complete the one-time payment.</p>
                </div>
                <div class="text-center">
                    <div class="flex items-center justify-center h-20 w-20 mx-auto bg-blue-50 rounded-full"><svg class="h-10 w-10 text-theme" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                    <h3 class="mt-4 font-semibold text-slate-800">2. Get Verified</h3>
                    <p class="mt-1 text-sm text-slate-500">We verify your payment and send your unique login credentials via email within 24 hours.</p>
                </div>
                <div class="text-center">
                    <div class="flex items-center justify-center h-20 w-20 mx-auto bg-blue-50 rounded-full"><svg class="h-10 w-10 text-theme" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></div>
                    <h3 class="mt-4 font-semibold text-slate-800">3. Track Progress</h3>
                    <p class="mt-1 text-sm text-slate-500">Log in to your private dashboard to track the 30-day processing of your request in real-time.</p>
                </div>
                <div class="text-center">
                    <div class="flex items-center justify-center h-20 w-20 mx-auto bg-blue-50 rounded-full"><svg class="h-10 w-10 text-theme" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg></div>
                    <h3 class="mt-4 font-semibold text-slate-800">4. Receive Your File</h3>
                    <p class="mt-1 text-sm text-slate-500">Get the complete, official PDF file delivered securely to your email.</p>
                </div>
            </div>
        </section>


        <section id="form-section" class="mt-20 md:mt-28 bg-white p-6 md:p-10 rounded-2xl shadow-xl border border-slate-200">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-slate-900">Start Your Request</h2>
                <p class="mt-2 text-slate-600">Fill the secure form below to begin. We handle the entire ATIP request on your behalf.</p>
            </div>
            <div class="mt-8 max-w-4xl mx-auto">
                <div class="relative h-[400px] overflow-hidden rounded-lg border border-slate-300">
                    <iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeWCiwlMQC2z536AvpAHkITWrvxN6Tbu-ywpL6A2fflPa_7VA/viewform?embedded=true" width="100%" height="500" frameborder="0" marginheight="0" marginwidth="0">Loadingâ€¦</iframe>
                </div>
            </div>
        </section>
        
        <section class="mt-12 text-center max-w-3xl mx-auto bg-sky-50 p-8 rounded-2xl border border-sky-200">
             <h3 class="text-xl font-bold text-sky-900">Track your Already Submitted Aplication</h3>
            <p class="text-sky-800 mt-2 mb-4">If your application has been verified, log in with the credentials sent to your email to track your request's progress.</p>
            <a href="login.html" class="bg-sky-500 hover:bg-sky-600 text-white font-bold py-3 px-6 rounded-lg inline-block transition-colors">Login to Dashboard</a>
        </section>

        <section id="reviews" class="mt-20 md:mt-28">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">What Our Clients Say</h2>
                <p class="text-slate-600 mt-2">Latest 10 feedbacks from applicants we've helped worldwide. You can share your valuable feedback. It will automatically appear here.</p>
            </div>
            <div class="relative overflow-hidden">
                <div id="review-carousel" class="review-carousel gap-x-8">
                    </div>
            </div>
             <div class="mt-8 text-center">
                <button id="prev-review" class="bg-white p-3 rounded-lg shadow-md border hover:bg-slate-100 transition-colors">&larr;</button>
                <button id="next-review" class="bg-white p-3 rounded-lg shadow-md border hover:bg-slate-100 transition-colors">&rarr;</button>
            </div>
            <div class="mt-12 text-center">
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSfOVN7CBcVzIECJuw-NzW24BC3zcCVR6830uewi35rGtb9dkw/viewform?usp=header" target="_blank" class="bg-amber-500 hover:bg-amber-600 text-white font-bold py-3 px-6 rounded-lg inline-block transition-colors">Leave Your Review</a>
            </div>
        </section>

    </main>

    <section class="bg-white border-t border-b border-slate-200 py-16">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
              <h3 class="text-3xl font-bold text-slate-900">Need a UK Visa File copies</h3>
              <p class="mt-4 text-slate-600 max-w-2xl mx-auto">We also provide official file copies from the UK Home Office to help you understand your UK visa refusal.</p>
              <div class="mt-8">
                  <a href="https://ukvisadata.netlify.app" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg inline-block transition-colors">Visit UK Docs Service</a>
              </div>
        </div>
    </section>

    <section id="contact" class="py-16">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center bg-white p-8 md:p-12 rounded-2xl border border-slate-200 shadow-lg">
                <div>
                    <h3 class="text-2xl font-bold text-slate-900">Take free help from our team</h3>
                    <p class="mt-2 text-slate-600">Our team is ready to assist you. Contact us via email or WhatsApp for a prompt response.</p>
                </div>
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-end gap-4">
                    <a href="mailto:asjhand9@gmail.com" class="bg-slate-200 hover:bg-slate-300 text-slate-800 text-center font-semibold py-3 px-5 rounded-lg transition-colors">asjhand9@gmail.com</a>
                    <a href="https://wa.me/919501415496" class="bg-green-500 hover:bg-green-600 text-white text-center font-semibold py-3 px-5 rounded-lg transition-colors">WhatsApp Support</a>
                </div>
            </div>
        </div>
    </section>


    <footer class="bg-slate-900 text-white">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 text-center text-sm text-slate-500">
            <p>&copy; 2025 CAIPS Notes Canada. All Rights Reserved.</p>
        </div>
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyB6hjkv_kve-EYj3J0nRhmcRa53slnzGtgtJrJ7WdL69vmzNn2-IPbXW9DvIxoaEJD/exec';
        
        const carousel = document.getElementById('review-carousel');
        const prevBtn = document.getElementById('prev-review');
        const nextBtn = document.getElementById('next-review');
        let reviewsData = [];
        let currentIndex = 0;
        let autoScrollInterval;

        function generateStars(rating) {
            let starsHTML = '';
            const starIcon = `<svg class="w-5 h-5 text-amber-400" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/></svg>`;
            for (let i = 0; i < 5; i++) {
                starsHTML += `<span class="${i < rating ? '' : 'opacity-30'}">${starIcon}</span>`;
            }
            return `<div class="flex items-center gap-1">${starsHTML}</div>`;
        }
        
        async function fetchAndDisplayReviews() {
            try {
                carousel.innerHTML = '<p class="w-full text-center text-slate-500 py-10">Loading testimonials...</p>';
                const response = await fetch(`${SCRIPT_URL}?action=getReviews`);
                if (!response.ok) throw new Error('Network response failed.');
                
                reviewsData = await response.json();
                if (reviewsData.error) throw new Error(reviewsData.message);

                carousel.innerHTML = ''; 
                
                if (!reviewsData || reviewsData.length === 0) {
                    carousel.innerHTML = '<p class="w-full text-center text-slate-500 py-10">No reviews yet. Be the first!</p>';
                    prevBtn.style.display = 'none';
                    nextBtn.style.display = 'none';
                    return;
                }

                reviewsData.forEach(review => {
                    const reviewCardHTML = `
                        <div class="review-card bg-white p-6 rounded-xl shadow-lg border border-slate-200 h-full flex flex-col">
                            ${generateStars(review.rating)}
                            <blockquote class="text-slate-700 mt-4 flex-grow text-lg">
                                <p>"${review.text}"</p>
                            </blockquote>
                            <footer class="mt-6 pt-4 border-t border-slate-200">
                                <p class="font-bold text-slate-900">${review.name}</p>
                                <div class="text-sm text-slate-500 mt-1">
                                    <span>${review.location}</span> | <span>${review.timestamp}</span>
                                </div>
                            </footer>
                        </div>
                    `;
                    carousel.innerHTML += reviewCardHTML;
                });

                updateCarousel();
                startAutoScroll();

            } catch (error) {
                console.error('Failed to fetch reviews:', error);
                carousel.innerHTML = `<p class="w-full text-center text-red-600 py-10">Error: Could not load reviews. (${error.message})</p>`;
            }
        }
        
        function getReviewsToShow() {
            if (window.innerWidth >= 1024) return 3;
            if (window.innerWidth >= 768) return 2;
            return 1;
        }

        function updateCarousel() {
            if (reviewsData.length === 0 || !carousel.children[0]) return;

            const reviewsToShow = getReviewsToShow();
            const totalReviews = reviewsData.length;
            if (totalReviews <= reviewsToShow) {
                 prevBtn.style.display = 'none';
                 nextBtn.style.display = 'none';
            } else {
                 prevBtn.style.display = 'inline-block';
                 nextBtn.style.display = 'inline-block';
            }

            const itemWidth = carousel.children[0].getBoundingClientRect().width;
            const gap = 32;
            const totalWidthToMove = itemWidth + gap;

            carousel.style.transform = `translateX(-${currentIndex * totalWidthToMove}px)`;
        }
        
        function startAutoScroll() {
            clearInterval(autoScrollInterval);
            autoScrollInterval = setInterval(() => {
                const reviewsToShow = getReviewsToShow();
                const maxIndex = reviewsData.length - reviewsToShow;
                if (currentIndex < maxIndex) {
                    currentIndex++;
                } else {
                    currentIndex = 0;
                }
                updateCarousel();
            }, 5000);
        }

        nextBtn.addEventListener('click', () => {
            const reviewsToShow = getReviewsToShow();
            if (currentIndex < reviewsData.length - reviewsToShow) {
                currentIndex++;
                updateCarousel();
                startAutoScroll();
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentIndex > 0) {
                currentIndex--;
                updateCarousel();
                startAutoScroll();
            }
        });
        
        window.addEventListener('resize', () => {
             const reviewsToShow = getReviewsToShow();
             if (currentIndex > reviewsData.length - reviewsToShow) {
                currentIndex = Math.max(0, reviewsData.length - reviewsToShow);
             }
             updateCarousel();
        });

        fetchAndDisplayReviews();
    });
    </script>
</body>
</html>
